{% extends 'admin/base2.html' %}

{% block content %}
{% with messages = get_flashed_messages(with_categories=True)%}
{% if messages %}
  {% for cat, msg in messages %}
    {% if cat =='error'%}
        <div class="alert alert-danger">{{ msg }}</div>
    {% else %}
        <div class="alert alert-success">{{ msg }}</div>
    {% endif %}
  {% endfor %}
{% endif %}
{% endwith %}

<h1>Breed Management</h1>

    
<!-- Display the form based on the mode -->
{% if mode == 'update' %}
    <h2>Update Breed</h2>
    <form action="/update/{{ breed.breed_id }}" method="post">
        <input type="hidden" name="csrf_token" value="{{csrf_token()}}">
        <input type="text" name="name" value="{{ breed.breed_name }}" required>
        <select name="category_id" id="category" required>
            <option value="" disabled selected>Select a category</option>
            {% for category in categories %}
                <option value="{{ category.category_id }}">{{ category.category_name }}</option>
            {% endfor %}
        </select>
        <button type="submit">Update</button>
    </form>
    <a href="/breed/">Back</a>
{% else %}
    <!-- Form to add a new breed -->
    <form action="/add" method="post">
        <input type="hidden" name="csrf_token" value="{{csrf_token()}}">
        <input type="text" name="name" placeholder="Breed Name" required>
        
        <!-- Dropdown for selecting category -->
        <label   class="col-sm-2 col-form-label" for="category">Select Category:</label>
        <select name="category_id" id="category" required>
            <option value="" disabled selected>Select a category</option>
            {% for category in categories %}
                <option value="{{ category.category_id }}">{{ category.category_name }}</option>
            {% endfor %}
        </select>
        
        <button class="btn btn-success mb-2" type="submit">Add Breed</button>
    </form>
    
    <!-- List of breeds with options to delete or update -->
    <table class="table table-striped table-bordered py-4">
        <thead>
            <tr>
                <th>Breed Name</th>
                <th>Category Name</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for breed in breeds %}
                <tr>
                    <td>{{ breed.breed_name }}</td>
                    <td>
                        {% for category in categories %}
                            {% if category.category_id == breed.category_id %}
                                {{ category.category_name }}
                            {% endif %}
                        {% endfor %}
                    </td>
                    <td>
                        <form action="/delete/{{ breed.breed_id }}" method="post" style="display:inline;">
                            <input type="hidden" name="csrf_token" value="{{csrf_token()}}">
                            <button class="btn btn-danger btn-sm" type="submit">Delete</button>
                        </form>
                        <a href="/update/{{ breed.breed_id }}" class="btn btn-warning btn-sm">Update</a>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
    
    
    
{% endif %}
    {% endblock %}
</body>
</html>
